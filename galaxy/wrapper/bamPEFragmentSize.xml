<tool id="deeptools_bamPEFragmentSize" name="bamPEFragmentSize" version="@WRAPPER_VERSION@.0">
    <description>Given a BAM file it samples several regions to estimate the paired-end fragment length</description>
    <macros>
        <token name="@BINARY@">bamPEFragmentSize</token>
        <import>deepTools_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command>
<![CDATA[
        ln -s $bamInput one.bam &&
        ln -s '${bamInput.metadata.bam_index}' one.bam.bai &&

        @BINARY@
            @THREADS@
            #if $histogram:
                --histogram ./hist.png
            #end if

            one.bam
            > $outfile
]]>
    </command>
    <inputs>
        <param name="bamInput" format="bam" type="data" label="BAM file"
            help="The BAM file must be sorted."/>
        <param argument="--histogram" type="boolean" truevalue="--histogram" falsevalue=""
            label="Get the distribion of fragment length as histogram"
            help=""/>
    </inputs>
    <outputs>
        <data name="outfile" format="txt"/>
        <data name="histogram_outfile" from_work_dir="hist.png" format="png">
            <filter>histogram is True</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="bamInput" value="bowtie2-test1.bam" ftype="bam" />
            <param name="histogram" value="True" />
            <output name="outfile" file="bamPEFragmentSize_result1.txt" ftype="txt" />
            <output name="histogram_outfile" file="bamPEFragmentSize_histogram_result1.png" ftype="png" compare="sim_size" />
        </test>
    </tests>
    <help>
<![CDATA[
**What it does**

Given a BAM file it samples several regions to estimate the paird-end fragment length.

-----

@REFERENCES@
]]>
    </help>
    <expand macro="citations" />
</tool>
