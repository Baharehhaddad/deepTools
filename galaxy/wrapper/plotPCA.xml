<tool id="deeptools_plot_pca" name="plotPCA" version="@WRAPPER_VERSION@.0">
    <description>generate a principal component analysis (PCA) plot from multiBamSummary or multiBigwigSummary output</description>
    <macros>
        <token name="@BINARY@">plotPCA</token>
        <import>deepTools_macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command>
<![CDATA[
        @BINARY@
            --corData "$corData"
            --plotTitle "$plotTitle"
            --plotFile "$outFileName"
            --plotFileFormat "$outFileFormat"
]]>
    </command>
    <inputs>
        <param name="corData" format="deeptools_coverage_matrix" type="data" label="Matrix file from the multiBamSummary or multiBigwigSummary tools"/>
        <expand macro="input_image_file_format" />
        <expand macro="plotTitle" />
    </inputs>
    <outputs>
        <expand macro="output_image_file_format_not_nested" />
    </outputs>
    <tests>
        <test>
            <param name="corData" value="multiBamSummary_result2.npz" ftype="deeptools_coverage_matrix" />
            <param name="plotTitle" value="Test Plot" />
            <param name="outFileFormat" value="png" />
            <output name="outFileName" file="plotPCA_result1.png" ftpye="png" compare="sim_size" delta="100" />
        </test>
    </tests>
    <help>
<![CDATA[

**What it does**

This tool takes the **default output file of multiBamSummary** or multiBigwigSummary to perform a principal component analysis (PCA).


Background
^^^^^^^^^^^

Principal component analysis (PCA) can be used, for example, to determine whether **samples display greater variability** between experimental conditions than between replicates of the same treatment. PCA is also useful to identify unexpected patterns, such as those caused by batch effects or outliers.
Principal components represent the directions along which the variation in the data is maximal, so that the information (e.g., read coverage values) from thousands of regions can be represented by just a few dimensions.

PCA is not necessarily meant to identify unknown groupings or clustering; it is up to the researcher to determine the experimental or technical reason underlying the principal components.

=======

**Example plot** 

.. image:: $PATH_TO_IMAGES/plotPCA_annotated.png

-----

@REFERENCES@
]]>
    </help>
    <expand macro="citations" />
</tool>
